//<script type="text/javascript" src="/share/js/share.js" async defer ></script>

mm_counters = document.getElementsByClassName("mmshare_counter");

function mmshare_open_ballon(obj){
    id = obj.getAttribute('id').substr(26);
    setTimeout(function(){
        container = document.getElementById('li-J-share_baloon_Share_' + id);
        mm_elements = container.getElementsByClassName('mmshare_r1');
        for (i in mm_elements){
          mm_elements[i].onclick = function(){
            window.open(this.href + '&js=1', "ShareMe", "menubar=no,location=no,resizable=no,scrollbars=no,status=no,width=640,height=480");
            container.getElementsByClassName('mmshare_counter')[0].innerHTML = parseInt( container.getElementsByClassName('mmshare_counter')[0].innerHTML ) + 1;
            return false;
          }
        }
        cnt = container.getElementsByClassName('mmshare_counter')[0];
        xmlhttp1 = getXmlHttp();
        xmlhttp1.open('GET', '/share/count.php?post=' + cnt.getAttribute('rel'), true);
        xhr_intvl = setInterval(function(){
            if (xmlhttp1.readyState == 4){
                cnt.innerHTML = xmlhttp1.responseText
                clearInterval(xhr_intvl);
            }
        }, 50);
        /*xmlhttp1.onreadystatechange = function() {
          if (xmlhttp1.readyState == 4) {
             if(xmlhttp1.status == 200) {
               cnt.innerHTML = xmlhttp1.responseText;
             }
          }
        };*/
        xmlhttp1.send(null);
        

    }, 200);
    return false;
}


function getXmlHttp(){
    var _xmlhttp;
    try {
        _xmlhttp = new ActiveXObject("Msxml2.XMLHTTP");
    }catch(e1){
        try {
            _xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
        } catch(e2){
            _xmlhttp = false;
        }
    }
    if (!_xmlhttp && typeof XMLHttpRequest!='undefined'){
        _xmlhttp = new XMLHttpRequest();
    }
    return _xmlhttp;
}
